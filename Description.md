# 🛡️ Multi-Layered DDoS Protection System

A comprehensive, multi-layered DDoS protection system that combines traditional security tools with modern monitoring and a machine learning-based detection engine.

## 🔧 Tech Stack

- **Web Server Protection**: Nginx Rate Limiting
- **Intrusion Prevention**: Fail2ban, Iptables
- **Web Application Firewall**: ModSecurity v3 + OWASP Core Rule Set
- **Behavioral Detection**: CrowdSec
- **Network Traffic Analysis**: Zeek + Zeek-Flowmeter
- **ML-based Detection**: Random Forest Classifier
  - Trained on CSE-CIC-IDS2018-AWS, CICIDS2017, and CIC DoS 2016 datasets
- **Monitoring & Visualization**: Prometheus + Grafana

## 🧱 Architecture

![Architecture](images/architecture.png)

## 📝 Features

- Rate limiting using Nginx for real-time filtering
- IP banning using Fail2ban based on suspicious behavior
- Deep packet inspection with ModSecurity (v3 WAF)
- Collaborative filtering and threat detection using CrowdSec
- Flow-based anomaly detection using Zeek
- Machine learning classification of network traffic (Benign vs DDoS)
- Real-time metrics via Prometheus and beautiful Grafana dashboards

## 🚀 Getting Started

### Prerequisites
- Ubuntu 20.04+
- Python 3.8+
- Docker (for Grafana/Prometheus setup)

### Installation
```bash
# Clone the repo
git clone https://github.com/yourusername/ddos-protection-system.git
cd ddos-protection-system

# Set up Python environment
pip install -r requirements.txt

# Run setup scripts for individual tools (refer to /src)
```

### Machine Learning Model
The Random Forest model is trained on labeled flow data generated by Zeek and exported via Zeek-Flowmeter. Accuracy ~99.91%.

## 📊 Grafana Dashboards
Sample metrics visualized:
- Incoming request rates
- Banned IPs
- Flow classifications (Benign vs DDoS)
- CPU/Memory/Network traffic stats

![Grafana Dashboard](images/grafana_dashboard.png)

## 📂 Project Structure
```
ddos-protection-system/
├── README.md
├── LICENSE
├── requirements.txt
├── images/
├── src/
│   ├── nginx/
│   ├── fail2ban/
│   ├── modsecurity/
│   ├── zeek/
│   └── ml_model/
└── dashboard/
```

## 🧪 Testing
Tested using:
- `hping3 -S --flood -p 80 <server-ip>` (SYN Flood)
- Packet inspection with Wireshark
- Real-time Zeek logs and Prometheus metrics

## 📖 License
MIT License

## 🙌 Acknowledgements
- [OWASP CRS](https://coreruleset.org/)
- [CIC DDoS datasets](https://www.unb.ca/cic/datasets/)
- [Zeek](https://zeek.org/)
- [Prometheus](https://prometheus.io/), [Grafana](https://grafana.com/)

---
> Built with passion to defend against the ever-growing threat of DDoS attacks.
